<script>
var cvgHeight = window.innerHeight
</script>


<!-- 

<div id="dots" style="position: fixed; left: 0; top: 0; bottom: 0; right: 0; background-image: url(<%= asset_path "dots.png" %>);background-position: 50% 50%; background-size: cover; z-index: 100; background-color: transparent; transform: rotateY(50deg); "></div>
 -->
<!-- ********** MAIN EVENTS PANEL ********** -->
<!-- ********** ***************** ********** -->
<!-- ********** ***************** ********** -->
<% @events.each_with_index do |event, i| %>
  <% if i == 0 %>
    <div class="splash" style="background-image: url(<%=eventImage(event)%>); background-position: 50% 50%; background-size: cover; z-index: -1"></div>
    <div id="splash-shift"></div>

    <script>
    var splashShift = document.querySelector("#splash-shift");
    splashShift.style.height = cvgHeight + 'px';

    
    </script>

    <nav>
      <li>Events</li>
      <li>Locations</li>
      <li><img src="<%= asset_path "casein/convergence.png" %>" /></li>
      <li>About</li>
      <li>Blog</li>
    </nav>

  <% else %>

    <div class="splash sub-splashes" style="background-image: url(<%=eventImage(event)%>); background-position: 50% 50%; background-size: cover; opacity: 0;"></div>

  <% end %>
<% end %>
<!-- ********** ***************** ********** -->
<!-- ********** ***************** ********** -->
<!-- ********** ***************** ********** -->





<script>
    var splashes = document.querySelectorAll(".splash");
    // [].forEach.call(subSplashes, function(el){
    //   el.style.height = cvgHeight + 'px';
    // })

    var current = 0;
    var numSplashes = splashes.length-1;

    function rotateEvents() {
      splashes[current].style.opacity = 0;
      current++;
      if (current > numSplashes) {
        current = 0;
      }
      splashes[current].style.opacity = 1;
    }

    window.setInterval(rotateEvents, 3000);
</script>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8/jquery.min.js"></script>

<script>
//var dots = $("#dots");

// window.onmousemove = function(e){
//   dots.css('transform', 'rotateY('+e.clientX+'deg)').css('transform', 'rotateX('+e.clientY+'deg)')
// }
</script>

<script type="text/javascript">
$(document).ready(function() {
  $('nav').waypoint('sticky');
});
</script>

<!-- EVENTS ROW -->
<div class="events row">
  <div style="z-index: 5">
    <div style="height: 200px; margin-top: 200px;">
        <div style="color: #888;">
          <p>content here</p>
          <p>content here</p>
          <p>content here</p>
        </div>
    </div>
  </div>
  <div style="left: 20%; background: #444; z-index: 4">
    <div style="height: 200px; margin-top: 200px;">
        <div style="color: #888;">
          <p>content here</p>
          <p>content here</p>
          <p>content here</p>
        </div>
    </div>
  </div>
  <div style="left: 40%; background: #555; z-index: 3">
    <div style="height: 200px; margin-top: 200px;">
        <div style="color: #888;">
          <p>content here</p>
          <p>content here</p>
          <p>content here</p>
        </div>
    </div>
  </div>
  <div style="left: 60%; background: #666; z-index: 2">
    <div style="height: 200px; margin-top: 200px;">
        <div style="color: #888;">
          <p>content here</p>
          <p>content here</p>
          <p>content here</p>
        </div>
    </div>
  </div>
  <div style="left: 80%; background: #777; z-index: 5">
    <div style="height: 200px; margin-top: 200px;">
        <div style="color: #888;">
          <p>content here</p>
          <p>content here</p>
          <p>content here</p>
        </div>
    </div>
  </div>
</div>
<!-- END EVENTS ROW -->

<!-- BLOG ROW -->
<div class="row">
  <h2>blog row</h2>
<div><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>

<div><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>

<div><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>
</div>
<!-- END BLOG ROW -->


<!-- VIDEO ROW -->
<div class="row">
  <h2>video row</h2>
<div><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>

<div><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>

<div><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>
</div>
<!-- END VIDEO ROW -->


<!-- MAILING LIST ROW -->
<div class="row">
  <h2>mailing list row</h2>
<div><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>

<div><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>
</div>
<!-- END MAILING LIST ROW -->



<!-- FOOTER ROW -->
<div class="row">
  <h2>footer row</h2>
<div><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>

<div><p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p></div>
</div>
<!-- END FOOTER ROW -->




<script type="application/processing">

 var  VerletPhysics2D = toxi.physics2d.VerletPhysics2D,
      VerletParticle2D = toxi.physics2d.VerletParticle2D,
      AttractionBehavior = toxi.physics2d.behaviors.AttractionBehavior,
      GravityBehavior = toxi.physics2d.behaviors.GravityBehavior,
      Vec2D = toxi.geom.Vec2D,
      Rect = toxi.geom.Rect;

import toxi.geom.*;
import toxi.physics2d.*;
import toxi.physics2d.behaviors.*;

int NUM_PARTICLES = 250;
int REST_LENGTH = 35;
VerletPhysics2D physics;
AttractionBehavior mouseAttractor;

Vec2D mousePos;

void setup() {
  size(window.innerWidth, window.innerHeight);
  physics = new VerletPhysics2D();
  physics.setDrag(0.05);
  physics.setWorldBounds(new Rect(0, 0, width, height));
  //physics.addBehavior(new GravityBehavior(new Vec2D(0, 0.15)));

  for(int y=0; y<(height/REST_LENGTH); y++) {
    for(int x=0; x<(width/REST_LENGTH); x++) {
      VerletParticle2D p = new VerletParticle2D(x*REST_LENGTH,y*REST_LENGTH);
      physics.addParticle(p);
      //physics.addBehavior(new AttractionBehavior(p, 20, -1.2, 0.01));
    }
  }
}

void addParticle() {
 // Vec2D randLoc = Vec2D.randomVector().scale(5).addSelf(width / 2, 0);
 //  VerletParticle2D p = new VerletParticle2D(randLoc);
 //  physics.addParticle(p); 
  //physics.addBehavior(new AttractionBehavior(p, 20, -1.2, 0.01));
}

void draw() {
  background(0,0,0,0);
  noStroke();
  fill(146, 37, 150, 100);
  // if (physics.particles.length < NUM_PARTICLES) {
  //   addParticle();
  // }
  physics.update();
  for (int i=0;i<physics.particles.length;i++) {
    VerletParticle2D p = physics.particles[i];
    ellipse(p.x, p.y, 5, 5);
  }
}

void mousePressed() {
  addParticle();
  mousePos = new Vec2D(mouseX, mouseY); 
  mouseAttractor = new AttractionBehavior(mousePos, 250, 0.9);
  physics.addBehavior(mouseAttractor);
}

void mouseDragged() { 
  mousePos.set(mouseX, mouseY);
}

void mouseReleased() { 
  physics.removeBehavior(mouseAttractor);
}
</script>

<canvas id="myCanvas" style="position: fixed; left:0; right: 0; top: 0; bottom: 0;"></canvas>
<script src="http://s3.amazonaws.com/toxiclibsjs/javascripts/vendor/processing.js"></script>
<script src="http://s3.amazonaws.com/toxiclibsjs/toxiclibsjs/build/toxiclibs.min.js"></script>
